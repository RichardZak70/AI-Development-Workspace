repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: mixed-line-ending
      - id: check-merge-conflict
      - id: check-json
        exclude: '^\.vscode/settings\.json$'
      - id: check-yaml
  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v3.1.0
    hooks:
      - id: prettier
        args: ["--check", "."]
        files: '\\.(json|jsonc|ya?ml|md)$'
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.6.9
    hooks:
      - id: ruff
        name: ruff (lint, includes docstrings)
        pass_filenames: false
        args: ["--output-format=full", "."]
  - repo: local
    hooks:
      - id: mypy
        name: mypy (scripts)
        entry: python -m mypy --config-file=mypy.ini scripts
        language: system
        pass_filenames: false
        types: [python]

  # Config YAML validation (schemas + required description fields).
  - repo: local
    hooks:
      - id: validate-config
        name: validate-config (config/*.yaml)
        entry: python scripts/validate_config.py
        language: system
        pass_filenames: false
        files: '^(templates/config|config)/.*\.ya?ml$'

  # Docstring structure + signature alignment (Google style).
  # Note: Ruff enforces docstring *convention* (pydocstyle/google). pydoclint
  # enforces that Args/Returns/Yields sections match the function signature.
  - repo: local
    hooks:
      - id: pydoclint
        name: pydoclint (docstring structure)
        entry: pydoclint
        language: python
        additional_dependencies:
          - pydoclint==0.8.3
        pass_filenames: false
        args:
          - --style
          - google
          - --skip-checking-short-docstrings
          - "False"
          - --arg-type-hints-in-docstring
          - "False"
          - --check-class-attributes
          - "False"
          - --skip-checking-raises
          - "True"
          - --check-return-types
          - "False"
          - --check-yield-types
          - "False"
          - scripts

  # Doc coverage for public, non-obvious entry points.
  - repo: https://github.com/econchick/interrogate
    rev: 1.7.0
    hooks:
      - id: interrogate
        args:
          - --style
          - google
          - --fail-under
          - '80'
          - --ignore-private
          - --ignore-semiprivate
          - --ignore-module
          - --exclude
          - tests
          - scripts

  # Prose linting for docs (comments + docs) using a pinned Vale runner.
  - repo: local
    hooks:
      - id: vale
        name: vale
        entry: python scripts/run_vale.py
        language: system
        pass_filenames: false
        files: '^(README\\.md|docs/.*\\.md)$'
        stages: [pre-commit]

  # Enforce high-quality JSDoc blocks for our JS scripts.
  - repo: local
    hooks:
      - id: eslint
        name: eslint (scripts/*.mjs)
        entry: npm run -s lint:js
        language: system
        pass_filenames: false
        files: '^scripts/.*\\.mjs$'
  - repo: local
    hooks:
      - id: pytest
        name: pytest
        entry: python -m pytest
        language: system
        pass_filenames: false
        stages: [pre-commit]
        types: [python]
